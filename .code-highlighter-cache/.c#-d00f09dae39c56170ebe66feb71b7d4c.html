<figure class='code-highlight-figure'><figcaption class='code-highlight-caption'><span class='code-highlight-caption-title'>ShimExample.cs</span><a class='code-highlight-caption-link' href='https://gist.github.com/6168604'>link</a></figcaption><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="na">[TestClass]</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">public</span> <span class="k">class</span> <span class="nc">TestClass1</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7b;</span> 
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="na">        [TestMethod]</span>
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestCurrentYear</span><span class="p">()</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="p">&#x7b;</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'>            <span class="kt">int</span> <span class="n">fixedYear</span> <span class="p">=</span> <span class="m">2000</span><span class="p">;</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>            <span class="k">using</span> <span class="p">(</span><span class="n">ShimsContext</span><span class="p">.</span><span class="n">Create</span><span class="p">())</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>            <span class="p">&#x7b;</span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'>                 <span class="c1">// Arrange:</span>
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="c1">// Detour DateTime.Now to return a fixed date:</span>
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="n">System</span><span class="p">.</span><span class="n">Fakes</span><span class="p">.</span><span class="n">ShimDateTime</span><span class="p">.</span><span class="n">NowGet</span> <span class="p">=</span> 
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="p">()</span> <span class="p">=&gt;</span>
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="p">&#x7b;</span> <span class="k">return</span> <span class="k">new</span> <span class="n">DateTime</span><span class="p">(</span><span class="n">fixedYear</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span> <span class="p">&#x7d;;</span>
</div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="c1">// Instantiate the component under test:</span>
</div></div><div data-line='18' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="kt">var</span> <span class="n">componentUnderTest</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MyComponent</span><span class="p">();</span>
</div></div><div data-line='19' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='20' class='code-highlight-row numbered'><div class='code-highlight-line'>                 <span class="c1">// Act:</span>
</div></div><div data-line='21' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="kt">int</span> <span class="n">year</span> <span class="p">=</span> <span class="n">componentUnderTest</span><span class="p">.</span><span class="n">GetTheCurrentYear</span><span class="p">();</span>
</div></div><div data-line='22' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='23' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="c1">// Assert: </span>
</div></div><div data-line='24' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="c1">// This will always be true if the component is working:</span>
</div></div><div data-line='25' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="n">Assert</span><span class="p">.</span><span class="n">AreEqual</span><span class="p">(</span><span class="n">fixedYear</span><span class="p">,</span> <span class="n">year</span><span class="p">);</span>
</div></div><div data-line='26' class='code-highlight-row numbered'><div class='code-highlight-line'>            <span class="p">&#x7d;</span>
</div></div><div data-line='27' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="p">&#x7d;</span>
</div></div><div data-line='28' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="p">&#x7d;</span></div></div></pre></div></figure>